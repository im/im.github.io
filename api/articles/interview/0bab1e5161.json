{"sort":61,"title":" 如何实现浏览器内多个标签页之间的通信？","slug":"interview/0bab1e5161","date":"2021-06-07T02:47:41.000Z","updated":"2021-06-17T11:25:09.047Z","comments":true,"path":"api/articles/interview/0bab1e5161.json","photos":[],"link":"","excerpt":null,"covers":null,"content":"<blockquote>\n<p>本题主要考察数据存储的知识，数据存储有本地和服务器存储两种方式。这里主要讲解用本地存储方式解决。即调用 localStorage、Cookie等本地存储方式。  </p>\n</blockquote>\n<h2 id=\"第一种-调用localStorage\"><a href=\"#第一种-调用localStorage\" class=\"headerlink\" title=\"第一种 调用localStorage\"></a>第一种 调用localStorage</h2><p>在一个标签页里面使用 localStorage.setItem(key,value)添加（修改、删除）内容；<br>在另一个标签页里面监听 storage 事件。<br>即可得到 localstorge 存储的值，实现不同标签页之间的通信。</p>\n<p>标签页1：</p>\n<pre><code class=\"hljs js\">&lt;input id=<span class=\"hljs-string\">&quot;name&quot;</span>&gt;  \n<span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;button&quot;</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;btn&quot;</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">&quot;提交&quot;</span>&gt;</span>  </span>\n<span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;text/javascript&quot;</span>&gt;</span><span class=\"javascript\">  </span></span>\n<span class=\"javascript\"><span class=\"xml\">    $(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>)</span>&#123;    </span></span>\n<span class=\"javascript\"><span class=\"xml\">        $(<span class=\"hljs-string\">&quot;#btn&quot;</span>).click(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>)</span>&#123;    </span></span>\n<span class=\"javascript\"><span class=\"xml\">            <span class=\"hljs-keyword\">var</span> name=$(<span class=\"hljs-string\">&quot;#name&quot;</span>).val();    </span></span>\n<span class=\"javascript\"><span class=\"xml\">            <span class=\"hljs-built_in\">localStorage</span>.setItem(<span class=\"hljs-string\">&quot;name&quot;</span>, name);   </span></span>\n<span class=\"javascript\"><span class=\"xml\">        &#125;);    </span></span>\n<span class=\"javascript\"><span class=\"xml\">    &#125;);    </span></span>\n<span class=\"javascript\"><span class=\"xml\"></span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>  </span></code></pre>\n\n<p>标签页2：</p>\n<pre><code class=\"hljs js\">&lt;script type=<span class=\"hljs-string\">&quot;text/javascript&quot;</span>&gt;  \n    $(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>)</span>&#123;   \n        <span class=\"hljs-built_in\">window</span>.addEventListener(<span class=\"hljs-string\">&quot;storage&quot;</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">event</span>)</span>&#123;    \n            <span class=\"hljs-built_in\">console</span>.log(event.key + <span class=\"hljs-string\">&quot;=&quot;</span> + event.newValue);    \n        &#125;);     \n    &#125;);  \n&lt;/script&gt;</code></pre>\n\n<h2 id=\"第二种-调用cookie-setInterval\"><a href=\"#第二种-调用cookie-setInterval\" class=\"headerlink\" title=\"第二种 调用cookie+setInterval()\"></a>第二种 调用cookie+setInterval()</h2><p>将要传递的信息存储在cookie中，每隔一定时间读取cookie信息，即可随时获取要传递的信息。</p>\n<p>页面1：</p>\n<pre><code class=\"hljs xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;name&quot;</span>&gt;</span>  \n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;button&quot;</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;btn&quot;</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">&quot;提交&quot;</span>&gt;</span>  \n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;text/javascript&quot;</span>&gt;</span><span class=\"javascript\">  </span>\n<span class=\"javascript\">    $(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>)</span>&#123;    </span>\n<span class=\"javascript\">        $(<span class=\"hljs-string\">&quot;#btn&quot;</span>).click(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>)</span>&#123;    </span>\n<span class=\"javascript\">            <span class=\"hljs-keyword\">var</span> name=$(<span class=\"hljs-string\">&quot;#name&quot;</span>).val();    </span>\n<span class=\"javascript\">            <span class=\"hljs-built_in\">document</span>.cookie=<span class=\"hljs-string\">&quot;name=&quot;</span>+name;    </span>\n<span class=\"javascript\">        &#125;);    </span>\n<span class=\"javascript\">    &#125;);    </span>\n<span class=\"javascript\"></span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span></code></pre>\n\n<p>页面2：</p>\n<pre><code class=\"hljs xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;text/javascript&quot;</span>&gt;</span><span class=\"javascript\">  </span>\n<span class=\"javascript\">    $(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>)</span>&#123;   </span>\n<span class=\"javascript\">        <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">getCookie</span>(<span class=\"hljs-params\">key</span>) </span>&#123;    </span>\n<span class=\"javascript\">            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">JSON</span>.parse(<span class=\"hljs-string\">&quot;&#123;\\&quot;&quot;</span> + <span class=\"hljs-built_in\">document</span>.cookie.replace(<span class=\"hljs-regexp\">/;\\s+/gim</span>,<span class=\"hljs-string\">&quot;\\&quot;,\\&quot;&quot;</span>).replace(<span class=\"hljs-regexp\">/=/gim</span>, <span class=\"hljs-string\">&quot;\\&quot;:\\&quot;&quot;</span>) + <span class=\"hljs-string\">&quot;\\&quot;&#125;&quot;</span>)[key];    </span>\n<span class=\"javascript\">        &#125;     </span>\n<span class=\"javascript\">        <span class=\"hljs-built_in\">setInterval</span>(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>)</span>&#123;    </span>\n<span class=\"javascript\">            <span class=\"hljs-built_in\">console</span>.log(<span class=\"hljs-string\">&quot;name=&quot;</span> + getCookie(<span class=\"hljs-string\">&quot;name&quot;</span>));    </span>\n<span class=\"javascript\">        &#125;, <span class=\"hljs-number\">10000</span>);    </span>\n<span class=\"javascript\">    &#125;);  </span>\n<span class=\"javascript\"></span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span></code></pre>\n\n\n","prev":{"title":" 从 Event Loop 角度解读 Vue NextTick 源码","slug":"vue/cdb7936afb"},"next":{"title":" HTML5的文件离线储存怎么使用，工作原理是什么？","slug":"interview/de0df6d619"},"categories":[{"name":"Interview","slug":"Interview","count":3,"path":"api/categories/Interview.json"}],"tags":[{"name":"Interview","slug":"Interview","count":3,"path":"api/tags/Interview.json"},{"name":"javascript","slug":"javascript","count":25,"path":"api/tags/javascript.json"}]}
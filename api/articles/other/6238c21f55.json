{"sort":46,"title":" ios æé†’äº‹é¡¹åŒæ­¥æ—¥å†å¿«æ·æŒ‡ä»¤è„šæœ¬","slug":"other/6238c21f55","date":"2021-05-03T00:00:00.000Z","updated":"2021-06-17T11:25:09.047Z","comments":true,"path":"api/articles/other/6238c21f55.json","photos":[],"link":"","excerpt":null,"covers":null,"content":"<ul>\n<li>AppStore å®‰è£…è¿è¡Œè„šæœ¬çš„è½¯ä»¶ <code>scriptable</code></li>\n</ul>\n<p><a href=\"https://docs.scriptable.app/\">scriptable https://docs.scriptable.app</a></p>\n<pre><code class=\"hljs js\"><span class=\"hljs-keyword\">const</span> DUR_MONTH = <span class=\"hljs-number\">1</span>\n\n<span class=\"hljs-keyword\">const</span> startDate = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">Date</span>()\nstartDate.setMonth(startDate.getMonth() - DUR_MONTH)\n<span class=\"hljs-built_in\">console</span>.log(<span class=\"hljs-string\">`æ—¥å†çš„å¼€å§‹æ—¶é—´ <span class=\"hljs-subst\">$&#123;startDate.toLocaleDateString()&#125;</span>`</span>)\n\n<span class=\"hljs-keyword\">const</span> endDate = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">Date</span>()\nendDate.setMonth(endDate.getMonth() + DUR_MONTH)\n<span class=\"hljs-built_in\">console</span>.log(<span class=\"hljs-string\">`æ—¥å†çš„ç»“æŸæ—¶é—´ <span class=\"hljs-subst\">$&#123;endDate.toLocaleDateString()&#125;</span>`</span>)\n\n<span class=\"hljs-keyword\">const</span> reminders = <span class=\"hljs-keyword\">await</span> Reminder.allDueBetween(startDate, endDate)\n<span class=\"hljs-built_in\">console</span>.log(<span class=\"hljs-string\">`è·å– <span class=\"hljs-subst\">$&#123;reminders.length&#125;</span> æ¡æé†’äº‹é¡¹`</span>)\n\n<span class=\"hljs-keyword\">var</span> calendar = <span class=\"hljs-keyword\">await</span> Calendar.forEvents()\n\n<span class=\"hljs-comment\">//è·å–æ—¥å†åå’Œå¯¹åº”çš„æ—¥å†</span>\n<span class=\"hljs-keyword\">var</span> m_dict = &#123;&#125;\n<span class=\"hljs-keyword\">for</span> (cal <span class=\"hljs-keyword\">of</span> calendar) &#123;\n    m_dict[cal.title] = cal\n&#125;\n\n<span class=\"hljs-keyword\">const</span> events = <span class=\"hljs-keyword\">await</span> CalendarEvent.between(startDate, endDate, calendar)\n<span class=\"hljs-built_in\">console</span>.log(<span class=\"hljs-string\">`è·å– <span class=\"hljs-subst\">$&#123;events.length&#125;</span> æ¡æ—¥å†`</span>)\n\n<span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">const</span> reminder <span class=\"hljs-keyword\">of</span> reminders) &#123;\n    <span class=\"hljs-comment\">//reminderçš„æ ‡è¯†ç¬¦</span>\n    <span class=\"hljs-keyword\">const</span> id = reminder.identifier.split(<span class=\"hljs-string\">&#x27;-&#x27;</span>)[<span class=\"hljs-number\">0</span>]\n    <span class=\"hljs-keyword\">const</span> targetNote = <span class=\"hljs-string\">`ğŸ§ <span class=\"hljs-subst\">$&#123;id&#125;</span> ğŸ°`</span>\n    <span class=\"hljs-comment\">// æ·»åŠ æ ‡è¯†ç¬¦å­˜è¿›å¤‡æ³¨ ç”¨æ¥é˜²æ­¢é‡å¤æ·»åŠ </span>\n    <span class=\"hljs-keyword\">const</span> [targetEvent] = events.filter(\n        <span class=\"hljs-function\">(<span class=\"hljs-params\">e</span>) =&gt;</span> e.notes != <span class=\"hljs-literal\">null</span> &amp;&amp; e.notes.indexOf(targetNote) != -<span class=\"hljs-number\">1</span>\n    ) <span class=\"hljs-comment\">//è¿‡æ»¤é‡å¤çš„reminder</span>\n    <span class=\"hljs-keyword\">if</span> (!m_dict[reminder.calendar.title]) &#123;\n        <span class=\"hljs-built_in\">console</span>.warn(<span class=\"hljs-string\">&#x27;æ‰¾ä¸åˆ°æ—¥å†&#x27;</span> + reminder.calendar.title)\n        <span class=\"hljs-keyword\">continue</span>\n    &#125;\n    <span class=\"hljs-keyword\">if</span> (targetEvent) &#123;\n        <span class=\"hljs-comment\">//console.log(`æ‰¾åˆ°å·²ç»åˆ›å»ºçš„äº‹é¡¹ $&#123;reminder.title&#125;`)</span>\n        updateEvent(targetEvent, reminder)\n    &#125; <span class=\"hljs-keyword\">else</span> &#123;\n        <span class=\"hljs-built_in\">console</span>.warn(<span class=\"hljs-string\">`åˆ›å»ºäº‹é¡¹ <span class=\"hljs-subst\">$&#123;reminder.title&#125;</span> åˆ° <span class=\"hljs-subst\">$&#123;reminder.calendar.title&#125;</span>`</span>)\n        <span class=\"hljs-keyword\">const</span> newEvent = <span class=\"hljs-keyword\">new</span> CalendarEvent()\n        <span class=\"hljs-keyword\">const</span> notes = reminder.notes ? reminder.notes : <span class=\"hljs-string\">&#x27;&#x27;</span>\n        newEvent.notes = targetNote + <span class=\"hljs-string\">&#x27;\\n\\n&#x27;</span> + notes <span class=\"hljs-comment\">//è¦åŠ å…¥å¤‡æ³¨</span>\n        updateEvent(newEvent, reminder)\n    &#125;\n&#125;\n\nScript.complete()\n\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">updateEvent</span>(<span class=\"hljs-params\">event, reminder</span>) </span>&#123;\n    event.title = <span class=\"hljs-string\">`<span class=\"hljs-subst\">$&#123;reminder.title&#125;</span>`</span>\n    cal_name = reminder.calendar.title\n    cal = m_dict[cal_name]\n    event.calendar = cal\n    <span class=\"hljs-comment\">//å·²å®Œæˆäº‹é¡¹</span>\n    <span class=\"hljs-keyword\">if</span> (reminder.isCompleted) &#123;\n        event.title = <span class=\"hljs-string\">`âœ… <span class=\"hljs-subst\">$&#123;reminder.title&#125;</span>`</span>\n        event.isAllDay = <span class=\"hljs-literal\">false</span>\n        event.startDate = reminder.completionDate\n        <span class=\"hljs-keyword\">var</span> ending = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">Date</span>(reminder.completionDate)\n        ending.setHours(ending.getHours() + <span class=\"hljs-number\">1</span>)\n        event.endDate = ending\n\n        <span class=\"hljs-keyword\">var</span> period =\n            (reminder.dueDate - reminder.completionDate) / <span class=\"hljs-number\">1000</span> / <span class=\"hljs-number\">3600</span> / <span class=\"hljs-number\">24</span>\n        period = period.toFixed(<span class=\"hljs-number\">1</span>)\n        <span class=\"hljs-keyword\">if</span> (period &lt; <span class=\"hljs-number\">0</span>) &#123;\n            period = -period\n            event.location = <span class=\"hljs-string\">&#x27; å»¶æœŸ&#x27;</span> + period + <span class=\"hljs-string\">&#x27;å¤©å®Œæˆ&#x27;</span>\n        &#125; <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (period == <span class=\"hljs-number\">0</span>) &#123;\n            event.location = <span class=\"hljs-string\">&#x27; å‡†æ—¶å®Œæˆ&#x27;</span>\n        &#125; <span class=\"hljs-keyword\">else</span> &#123;\n            event.location = <span class=\"hljs-string\">&#x27; æå‰&#x27;</span> + period + <span class=\"hljs-string\">&#x27;å¤©å®Œæˆ&#x27;</span>\n        &#125;\n    &#125;\n    <span class=\"hljs-comment\">//æœªå®Œæˆäº‹é¡¹</span>\n    <span class=\"hljs-keyword\">else</span> &#123;\n        <span class=\"hljs-keyword\">const</span> nowtime = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">Date</span>()\n        <span class=\"hljs-keyword\">var</span> period = (reminder.dueDate - nowtime) / <span class=\"hljs-number\">1000</span> / <span class=\"hljs-number\">3600</span> / <span class=\"hljs-number\">24</span>\n        period = period.toFixed(<span class=\"hljs-number\">1</span>)\n        <span class=\"hljs-keyword\">if</span> (period &lt; <span class=\"hljs-number\">0</span>) &#123;\n            <span class=\"hljs-comment\">//å¾…åŠé¡ºå»¶</span>\n\n            event.location = <span class=\"hljs-string\">&#x27; å»¶æœŸ&#x27;</span> + -period + <span class=\"hljs-string\">&#x27;å¤©&#x27;</span>\n            <span class=\"hljs-comment\">//å¦‚æœä¸æ˜¯åœ¨åŒä¸€å¤©,è®¾ç½®ä¸ºå…¨å¤©äº‹é¡¹</span>\n            <span class=\"hljs-keyword\">if</span> (reminder.dueDate.getDate() != nowtime.getDate()) &#123;\n                event.title = <span class=\"hljs-string\">`âŒ <span class=\"hljs-subst\">$&#123;reminder.title&#125;</span>`</span>\n                event.startDate = nowtime\n                event.endDate = nowtime\n                event.isAllDay = <span class=\"hljs-literal\">true</span>\n            &#125;\n            <span class=\"hljs-comment\">//åœ¨åŒä¸€å¤©çš„ä¿æŒåŸæ¥çš„æ—¶é—´</span>\n            <span class=\"hljs-keyword\">else</span> &#123;\n                event.title = <span class=\"hljs-string\">`â­•ï¸ <span class=\"hljs-subst\">$&#123;reminder.title&#125;</span>`</span>\n                event.isAllDay = <span class=\"hljs-literal\">false</span>\n                event.startDate = reminder.dueDate\n                <span class=\"hljs-keyword\">var</span> ending = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">Date</span>(reminder.dueDate)\n                ending.setHours(ending.getHours() + <span class=\"hljs-number\">1</span>)\n                event.endDate = ending\n            &#125;\n            <span class=\"hljs-built_in\">console</span>.log(<span class=\"hljs-string\">`ã€<span class=\"hljs-subst\">$&#123;reminder.title&#125;</span>ã€‘å¾…åŠé¡ºå»¶<span class=\"hljs-subst\">$&#123;-period&#125;</span>å¤©`</span>)\n        &#125; <span class=\"hljs-keyword\">else</span> &#123;\n            event.title = <span class=\"hljs-string\">`â­•ï¸ <span class=\"hljs-subst\">$&#123;reminder.title&#125;</span>`</span>\n            event.isAllDay = <span class=\"hljs-literal\">false</span>\n            event.location = <span class=\"hljs-string\">&#x27;è¿˜å‰©&#x27;</span> + period + <span class=\"hljs-string\">&#x27;å¤©&#x27;</span>\n            event.startDate = reminder.dueDate\n            <span class=\"hljs-keyword\">var</span> ending = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">Date</span>(reminder.dueDate)\n            ending.setHours(ending.getHours() + <span class=\"hljs-number\">1</span>)\n            event.endDate = ending\n        &#125;\n    &#125;\n    event.save()\n&#125;\n</code></pre>\n\n<ul>\n<li>æé†’äº‹é¡¹æ•°æ®æ ¼å¼</li>\n</ul>\n<pre><code class=\"hljs json\">&#123;\n  <span class=\"hljs-attr\">&quot;identifier&quot;</span>: <span class=\"hljs-string\">&quot;29803A1E-6C2F-454D-B366-2C67EB1F24BD&quot;</span>,\n  <span class=\"hljs-attr\">&quot;title&quot;</span>: <span class=\"hljs-string\">&quot;Recite word&quot;</span>,\n  <span class=\"hljs-attr\">&quot;isCompleted&quot;</span>: <span class=\"hljs-literal\">false</span>,\n  <span class=\"hljs-attr\">&quot;isOverdue&quot;</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">&quot;priority&quot;</span>: <span class=\"hljs-number\">0</span>,\n  <span class=\"hljs-attr\">&quot;dueDate&quot;</span>: <span class=\"hljs-string\">&quot;2021-03-11T23:20:00.000Z&quot;</span>,\n  <span class=\"hljs-attr\">&quot;dueDateIncludesTime&quot;</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">&quot;completionDate&quot;</span>: <span class=\"hljs-literal\">null</span>,\n  <span class=\"hljs-attr\">&quot;creationDate&quot;</span>: <span class=\"hljs-string\">&quot;2021-03-12T03:28:00.621Z&quot;</span>,\n  <span class=\"hljs-attr\">&quot;calendar&quot;</span>: &#123;\n    <span class=\"hljs-attr\">&quot;identifier&quot;</span>: <span class=\"hljs-string\">&quot;282088E0-DC16-4827-BA21-9B9FD5F0A16F&quot;</span>,\n    <span class=\"hljs-attr\">&quot;title&quot;</span>: <span class=\"hljs-string\">&quot;Learn&quot;</span>,\n    <span class=\"hljs-attr\">&quot;isSubscribed&quot;</span>: <span class=\"hljs-literal\">false</span>,\n    <span class=\"hljs-attr\">&quot;allowsContentModifications&quot;</span>: <span class=\"hljs-literal\">true</span>,\n    <span class=\"hljs-attr\">&quot;color&quot;</span>: &#123;\n      <span class=\"hljs-attr\">&quot;hex&quot;</span>: <span class=\"hljs-string\">&quot;FF2968&quot;</span>,\n      <span class=\"hljs-attr\">&quot;red&quot;</span>: <span class=\"hljs-number\">1</span>,\n      <span class=\"hljs-attr\">&quot;green&quot;</span>: <span class=\"hljs-number\">0.1607843041419983</span>,\n      <span class=\"hljs-attr\">&quot;blue&quot;</span>: <span class=\"hljs-number\">0.40784314274787903</span>,\n      <span class=\"hljs-attr\">&quot;alpha&quot;</span>: <span class=\"hljs-number\">1</span>\n    &#125;\n  &#125;\n&#125;\n</code></pre>\n\n<p><a href=\"https://tangxiaomi.top/2021/03/12/other/reminders-sync-calendar/\">ios æé†’äº‹é¡¹åŒæ­¥æ—¥å†å¿«æ·æŒ‡ä»¤è„šæœ¬</a></p>\n","prev":{"title":" æšä¸¾","slug":"typescript/1c6b93719a"},"next":{"title":" ç±»","slug":"typescript/98dfa9bae0"},"categories":[{"name":"other","slug":"other","count":4,"path":"api/categories/other.json"}],"tags":[{"name":"other","slug":"other","count":4,"path":"api/tags/other.json"}]}
<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>糖小米 · 博客</title>
  
  <subtitle>厚积薄发</subtitle>
  <link href="https://tangxiaomi.top/atom.xml" rel="self"/>
  
  <link href="https://tangxiaomi.top/"/>
  <updated>2021-05-26T07:04:31.965Z</updated>
  <id>https://tangxiaomi.top/</id>
  
  <author>
    <name>糖小米</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Nodejs 展示文件夹</title>
    <link href="https://tangxiaomi.top/2021/04/17/javascript/node-show-catalogue/"/>
    <id>https://tangxiaomi.top/2021/04/17/javascript/node-show-catalogue/</id>
    <published>2021-04-17T00:00:00.000Z</published>
    <updated>2021-05-26T07:04:31.965Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = express()</span><br><span class="line"><span class="keyword">const</span> port = <span class="number">80</span></span><br><span class="line"><span class="keyword">var</span> serveIndex = <span class="built_in">require</span>(<span class="string">&#x27;serve-index&#x27;</span>)</span><br><span class="line"></span><br><span class="line">app.use(express.static(<span class="string">&#x27;../&#x27;</span>))</span><br><span class="line">app.use(serveIndex(<span class="string">&#x27;../&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getIPAdress</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> interfaces = <span class="built_in">require</span>(<span class="string">&#x27;os&#x27;</span>).networkInterfaces()</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> devName <span class="keyword">in</span> interfaces) &#123;</span><br><span class="line">        <span class="keyword">var</span> iface = interfaces[devName]</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; iface.length; i++) &#123;</span><br><span class="line">            <span class="keyword">let</span> alias = iface[i]</span><br><span class="line">            <span class="keyword">if</span> (</span><br><span class="line">                alias.family === <span class="string">&#x27;IPv4&#x27;</span> &amp;&amp;</span><br><span class="line">                alias.address !== <span class="string">&#x27;127.0.0.1&#x27;</span> &amp;&amp;</span><br><span class="line">                !alias.internal</span><br><span class="line">            ) &#123;</span><br><span class="line">                <span class="comment">// console.log(alias.address);</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> alias.address</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> server = http.createServer(app)</span><br><span class="line"></span><br><span class="line">server.listen(port, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Example app listening at http://<span class="subst">$&#123;getIPAdress()&#125;</span>:<span class="subst">$&#123;port&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;l</summary>
      
    
    
    
    <category term="javascript" scheme="https://tangxiaomi.top/categories/javascript/"/>
    
    
    <category term="nodejs" scheme="https://tangxiaomi.top/tags/nodejs/"/>
    
  </entry>
  
  <entry>
    <title>HTML5 Canvas生成粒子效果</title>
    <link href="https://tangxiaomi.top/2021/03/02/javascript/html5-canvas-particle-effect/"/>
    <id>https://tangxiaomi.top/2021/03/02/javascript/html5-canvas-particle-effect/</id>
    <published>2021-03-02T00:00:00.000Z</published>
    <updated>2021-05-26T07:04:31.965Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h2><p><a href="https://cdn.jsdelivr.net/gh/im/oss@master/js/breathing-halftone.pkgd.min.js">breathing-halftone.pkgd.min.js</a></p><h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// get the image</span></span><br><span class="line"><span class="comment">// jquery</span></span><br><span class="line"><span class="keyword">var</span> img = $(<span class="string">&#x27;#hero img&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="comment">// or vanilla JS</span></span><br><span class="line"><span class="keyword">var</span> img = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;#hero img&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// init halftone</span></span><br><span class="line"><span class="keyword">new</span> BreathingHalftone(img, &#123;</span><br><span class="line">    <span class="comment">// options...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;dotSize&quot;</span>: <span class="number">1</span> / <span class="number">150</span>,</span><br><span class="line">    <span class="comment">//点的大小</span></span><br><span class="line">    <span class="comment">//作为图像对角线的一小部分</span></span><br><span class="line">    <span class="comment">//较小的点=较多的点=性能较差</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;dotSizeThreshold&quot;</span>: <span class="number">0.05</span>,</span><br><span class="line">    <span class="comment">//隐藏小于百分比的点</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;initVelocity&quot;</span>: <span class="number">0.1</span>,</span><br><span class="line">    <span class="comment">//点开始增长的速度</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;oscPeriod&quot;</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="comment">//点大小振荡或“呼吸”周期的持续时间（以秒为单位）</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;oscAmplitude&quot;</span>: <span class="number">0.2</span>,</span><br><span class="line">    <span class="comment">//振荡变化百分比</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;isAdditive&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">//添加剂是带有RGB点的黑色，</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//减法为带有CMK点的白色</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;isRadial&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">//启用径向网格布局</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;channels&quot;</span>: [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>],</span><br><span class="line">    <span class="comment">//点层</span></span><br><span class="line">    <span class="comment">//&#x27;lum&#x27;是另一个受支持的通道，以实现亮度</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;isChannelLens&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">//禁用位移时更改点的大小</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;friction&quot;</span>: <span class="number">0.06</span>,</span><br><span class="line">    <span class="comment">//较低的点使点更容易移动，较高的点使点更难</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;hoverDiameter&quot;</span>: <span class="number">0.2</span>,</span><br><span class="line">    <span class="comment">//悬停效果的大小</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//作为图像对角线的一小部分</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;hoverForce&quot;</span>: <span class="number">0.01</span>,</span><br><span class="line">    <span class="comment">//悬停效果的力量</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//负值会拉入点，正值会拉出</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;activeDiameter&quot;</span>: <span class="number">0.6</span>,</span><br><span class="line">    <span class="comment">//点击/点击效果的大小</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//作为图像对角线的一小部分</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;activeForce&quot;</span>: <span class="number">0.01</span></span><br><span class="line">    <span class="comment">//悬停效果的力量</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//负值会拉入点，正值会拉出</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Dome"><a href="#Dome" class="headerlink" title="Dome"></a>Dome</h2><script src="https://cdn.jsdelivr.net/gh/im/oss@master/js/breathing-halftone.pkgd.min.js"></script><img width="400" height="400" id="html5-canvas-particle-effect-dome" src="/images/header/avatar.jpg" /><script>window.onload = function () {    var img = document.getElementById('html5-canvas-particle-effect-dome')    new BreathingHalftone(img, {        "dotSize": 1 / 150    })}</script><h2 id="Quote"><a href="#Quote" class="headerlink" title="Quote"></a>Quote</h2><blockquote><p><a href="http://breathing-halftone.desandro.com/">http://breathing-halftone.desandro.com/</a></p></blockquote>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;Install&quot;&gt;&lt;a href=&quot;#Install&quot; class=&quot;headerlink&quot; title=&quot;Install&quot;&gt;&lt;/a&gt;Install&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://cdn.jsdelivr.net/gh/im/oss@master/js/breathing-halftone.pkgd.min.js&quot;&gt;breathing-halftone.pkgd.min.js&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;Usage&quot;&gt;&lt;a href=&quot;#Usage&quot; class=&quot;headerlink&quot; title=&quot;Usage&quot;&gt;&lt;/a&gt;Usage&lt;/h2&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// get the image&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// jquery&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; img = $(&lt;span class=&quot;string&quot;&gt;&amp;#x27;#hero img&amp;#x27;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// or vanilla JS&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; img = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.querySelector(&lt;span class=&quot;string&quot;&gt;&amp;#x27;#hero img&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// init halftone&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; BreathingHalftone(img, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// options...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="javascript" scheme="https://tangxiaomi.top/categories/javascript/"/>
    
    
    <category term="js" scheme="https://tangxiaomi.top/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript 实现复制粘贴</title>
    <link href="https://tangxiaomi.top/2021/02/07/javascript/copy/"/>
    <id>https://tangxiaomi.top/2021/02/07/javascript/copy/</id>
    <published>2021-02-07T00:00:00.000Z</published>
    <updated>2021-05-26T07:04:31.965Z</updated>
    
    <content type="html"><![CDATA[<h2 id="实现思路"><a href="#实现思路" class="headerlink" title="实现思路"></a>实现思路</h2><p>html:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;copyToClip(&#x27;内容&#x27;)&quot;</span>&gt;</span>Copy<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p>javascript:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 复制内容到粘贴板</span></span><br><span class="line"><span class="comment"> * content : 需要复制的内容</span></span><br><span class="line"><span class="comment"> * message : 复制完后的提示，不传则默认提示&quot;复制成功&quot;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">copyToClip</span>(<span class="params">content, message</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> aux = <span class="built_in">document</span>.createElement(<span class="string">&#x27;input&#x27;</span>)</span><br><span class="line">    aux.setAttribute(<span class="string">&#x27;value&#x27;</span>, content)</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(aux)</span><br><span class="line">    aux.select()</span><br><span class="line">    <span class="built_in">document</span>.execCommand(<span class="string">&#x27;copy&#x27;</span>)</span><br><span class="line">    <span class="built_in">document</span>.body.removeChild(aux)</span><br><span class="line">    <span class="keyword">if</span> (message == <span class="literal">null</span>) &#123;</span><br><span class="line">        alert(<span class="string">&#x27;复制成功&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        alert(mesage)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="clipboard-js-https-clipboardjs-com"><a href="#clipboard-js-https-clipboardjs-com" class="headerlink" title="(clipboard.js)[https://clipboardjs.com/]"></a>(clipboard.js)[<a href="https://clipboardjs.com/]">https://clipboardjs.com/]</a></h3><p>直接引用： <code>&lt;script src=&quot;dist/clipboard.min.js&quot;&gt;&lt;/script&gt;</code></p><p>包： <code>npm install clipboard --save </code>，然后 <code>import Clipboard from &#39;clipboard&#39;</code></p><p>html:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;demoInput&quot;</span> <span class="attr">value</span>=<span class="string">&quot;hello world&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span> <span class="attr">data-clipboard-target</span>=<span class="string">&quot;#demoInput&quot;</span>&gt;</span>点我复制<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p>javascript:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Clipboard <span class="keyword">from</span> <span class="string">&#x27;clipboard&#x27;</span></span><br><span class="line"><span class="keyword">const</span> btnCopy = <span class="keyword">new</span> Clipboard(<span class="string">&#x27;btn&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;实现思路&quot;&gt;&lt;a href=&quot;#实现思路&quot; class=&quot;headerlink&quot; title=&quot;实现思路&quot;&gt;&lt;/a&gt;实现思路&lt;/h2&gt;&lt;p&gt;html:&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;button&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;onclick&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&amp;quot;copyToClip(&amp;#x27;内容&amp;#x27;)&amp;quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;Copy&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;button&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;javascript:&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt; * 复制内容到粘贴板&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt; * content : 需要复制的内容&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt; * message : 复制完后的提示，不传则默认提示&amp;quot;复制成功&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;copyToClip&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;content, message&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; aux = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.createElement(&lt;span class=&quot;string&quot;&gt;&amp;#x27;input&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    aux.setAttribute(&lt;span class=&quot;string&quot;&gt;&amp;#x27;value&amp;#x27;&lt;/span&gt;, content)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.body.appendChild(aux)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    aux.select()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.execCommand(&lt;span class=&quot;string&quot;&gt;&amp;#x27;copy&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.body.removeChild(aux)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (message == &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        alert(&lt;span class=&quot;string&quot;&gt;&amp;#x27;复制成功&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        alert(mesage)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="javascript" scheme="https://tangxiaomi.top/categories/javascript/"/>
    
    
    <category term="code blocks" scheme="https://tangxiaomi.top/tags/code-blocks/"/>
    
    <category term="js" scheme="https://tangxiaomi.top/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript 实现前端下载图片</title>
    <link href="https://tangxiaomi.top/2021/02/07/javascript/download-image/"/>
    <id>https://tangxiaomi.top/2021/02/07/javascript/download-image/</id>
    <published>2021-02-07T00:00:00.000Z</published>
    <updated>2021-05-26T07:04:31.965Z</updated>
    
    <content type="html"><![CDATA[<h2 id="实现思路"><a href="#实现思路" class="headerlink" title="实现思路"></a>实现思路</h2><ul><li>  将图片装换成 Data URLs</li><li>  下载图片</li></ul><h4 id="Data-URLs"><a href="#Data-URLs" class="headerlink" title="Data URLs"></a>Data URLs</h4><blockquote><p>Data URLs，即前缀为 data: 协议的的 URL，其允许内容创建者向文档中嵌入小文件。<br>Data URLs 由四个部分组成：前缀(data:)、指示数据类型的 MIME 类型、如果非文本则为可选的 base64 标记、数据本身：<br>data:[<mediatype>][;base64],<data><br>mediatype 是个 MIME 类型的字符串，例如 “image/jpeg” 表示 JPEG 图像文件。如果被省略，则默认值为 text/plain;charset=US-ASCII<br>如果数据是文本类型，你可以直接将文本嵌入 (根据文档类型，使用合适的实体字符或转义字符)。如果是二进制数据，你可以将数据进行 base64 编码之后再进行嵌入。</p></blockquote><p>详细请看 MDN 对 <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/data_URIs">Data URLs</a> 的解释。</p><a id="more"></a><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>以下是获取图片 DataURL 的示例代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 获取图片的 base64 编码 DataURL</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param </span>image JS 图像对象</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return <span class="type">&#123;string&#125;</span> </span>已编码的 DataURL</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="title">getImageDataURL</span>(<span class="params">image</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 创建画布</span></span><br><span class="line">    <span class="keyword">const</span> canvas = <span class="built_in">document</span>.createElement(<span class="string">&#x27;canvas&#x27;</span>);</span><br><span class="line">    canvas.width = image.width;</span><br><span class="line">    canvas.height = image.height;</span><br><span class="line">    <span class="keyword">const</span> ctx = canvas.getContext(<span class="string">&#x27;2d&#x27;</span>);</span><br><span class="line">    <span class="comment">// 以图片为背景剪裁画布</span></span><br><span class="line">    ctx.drawImage(image, <span class="number">0</span>, <span class="number">0</span>, image.width, image.height);</span><br><span class="line">    <span class="comment">// 获取图片后缀名</span></span><br><span class="line">    <span class="keyword">const</span> extension = image.src.substring(image.src.lastIndexOf(<span class="string">&#x27;.&#x27;</span>) + <span class="number">1</span>).toLowerCase();</span><br><span class="line">    <span class="comment">// 某些图片 url 可能没有后缀名，默认是 png</span></span><br><span class="line">    <span class="keyword">return</span> canvas.toDataURL(<span class="string">&#x27;image/&#x27;</span> + extension, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行上面的函数后会返回如下面的格式一样的字符串</p><p>data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAgAElEQVR4Xu1dB3hUxfb/bc3uppOeQOgIAioKCiqWJ/bysFd89vcXe0WfvSJ2wY6gPhX1WZ…</p><p>注意：图片越大，转换后的 base64 编码越长，尽量避免对大图进行 DataURL 转换，防止转换后的长度超出浏览器限制</p><p>以下是下载图片的示例代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">downLoad</span>(<span class="params">downloadName, url</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> tag = <span class="built_in">document</span>.createElement(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    <span class="comment">// 此属性的值就是下载时图片的名称，注意，名称中不能有半角点，否则下载时后缀名会错误</span></span><br><span class="line">    tag.setAttribute(<span class="string">&#x27;download&#x27;</span>, downloadName.replace(<span class="regexp">/\./g</span>, <span class="string">&#x27;。&#x27;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> image = <span class="keyword">new</span> Image();</span><br><span class="line">    <span class="comment">// 设置 image 的 url, 添加时间戳，防止浏览器缓存图片</span></span><br><span class="line">    image.src = url + <span class="string">&#x27;?time=&#x27;</span> + <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line">    <span class="comment">//重要，设置 crossOrigin 属性，否则图片跨域会报错</span></span><br><span class="line">    image.setAttribute(<span class="string">&#x27;crossOrigin&#x27;</span>, <span class="string">&#x27;Anonymous&#x27;</span>);</span><br><span class="line">    <span class="comment">// 图片未加载完成时操作会报错</span></span><br><span class="line">    image.onload = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        tag.href = getImageDataURL(image);</span><br><span class="line">        tag.click();</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;实现思路&quot;&gt;&lt;a href=&quot;#实现思路&quot; class=&quot;headerlink&quot; title=&quot;实现思路&quot;&gt;&lt;/a&gt;实现思路&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;  将图片装换成 Data URLs&lt;/li&gt;
&lt;li&gt;  下载图片&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;Data-URLs&quot;&gt;&lt;a href=&quot;#Data-URLs&quot; class=&quot;headerlink&quot; title=&quot;Data URLs&quot;&gt;&lt;/a&gt;Data URLs&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;Data URLs，即前缀为 data: 协议的的 URL，其允许内容创建者向文档中嵌入小文件。&lt;br&gt;Data URLs 由四个部分组成：前缀(data:)、指示数据类型的 MIME 类型、如果非文本则为可选的 base64 标记、数据本身：&lt;br&gt;data:[&lt;mediatype&gt;][;base64],&lt;data&gt;&lt;br&gt;mediatype 是个 MIME 类型的字符串，例如 “image/jpeg” 表示 JPEG 图像文件。如果被省略，则默认值为 text/plain;charset=US-ASCII&lt;br&gt;如果数据是文本类型，你可以直接将文本嵌入 (根据文档类型，使用合适的实体字符或转义字符)。如果是二进制数据，你可以将数据进行 base64 编码之后再进行嵌入。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;详细请看 MDN 对 &lt;a href=&quot;https://developer.mozilla.org/zh-CN/docs/Web/HTTP/data_URIs&quot;&gt;Data URLs&lt;/a&gt; 的解释。&lt;/p&gt;</summary>
    
    
    
    <category term="javascript" scheme="https://tangxiaomi.top/categories/javascript/"/>
    
    
    <category term="code blocks" scheme="https://tangxiaomi.top/tags/code-blocks/"/>
    
    <category term="js" scheme="https://tangxiaomi.top/tags/js/"/>
    
  </entry>
  
</feed>
